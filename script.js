// =====================
// 1. Configure handbook
// =====================

const HANDBOOK_TEXT = `
NovaTech Labs
Employee Handbook

Effective Date: January 1, 2025
Applies To: All employees of NovaTech Labs, including full-time, part-time, temporary, and remote workers, unless otherwise specified.

Important Note:
This handbook is a general guide to NovaTech Labs’ policies and practices. It is not an employment contract and does not create any contractual rights. NovaTech Labs may modify, revoke, suspend, or change any or all such plans, policies, or procedures at any time, with or without notice, consistent with applicable law.

1. Welcome to NovaTech Labs
1.1 Our Mission

NovaTech Labs designs and delivers smart digital products that help businesses work simpler, faster, and more securely. Our mission is to create technology that feels human—intuitive, reliable, and trustworthy.

1.2 Our Values

We expect every employee to uphold our core values:

Integrity – We do the right thing, even when it’s difficult or inconvenient.

Respect – We treat colleagues, customers, and partners with professionalism and dignity.

Ownership – We take responsibility for our work and the impact of our decisions.

Curiosity – We ask questions, seek feedback, and keep learning.

Collaboration – We win as a team; we share knowledge and support each other.

Customer Focus – We make choices that create long-term value for our customers.

1.3 About This Handbook

This handbook summarizes key policies, procedures, and expectations. It does not cover every situation. When in doubt:

Talk to your manager

Contact People Operations (HR) at peopleops@novatechlabs.com

If any policy conflicts with applicable law, the law will govern.

2. Employment at NovaTech
2.1 At-Will Employment

Employment at NovaTech Labs is at-will where permitted by law. This means:

You may resign at any time, with or without notice.

NovaTech Labs may terminate employment at any time, with or without cause or notice, consistent with applicable laws.

Nothing in this handbook, or any other document, changes this at-will relationship unless expressed in a written agreement signed by the CEO or designee.

2.2 Equal Employment Opportunity (EEO)

NovaTech Labs is an equal opportunity employer. We do not discriminate based on race, color, religion, gender, gender identity or expression, sexual orientation, national origin, age, disability, marital status, veteran status, genetic information, or any other status protected by law.

All employment decisions—including hiring, promotion, compensation, benefits, training, and termination—are based on job-related criteria and business needs.

2.3 Anti-Harassment & Anti-Discrimination

NovaTech Labs strictly prohibits any form of unlawful harassment or discrimination. This includes, but is not limited to:

Unwelcome verbal, visual, or physical conduct based on a protected characteristic

Sexual harassment (including unwelcome advances, requests for sexual favors, or other verbal/physical conduct of a sexual nature)

Offensive jokes, slurs, epithets, or insults aimed at a protected group

Reporting:
If you experience or witness harassment or discrimination:

If you feel safe, tell the person to stop.

Report it promptly to your manager or People Operations.

If you are uncomfortable going through your manager or HR, you may report directly to any senior leader.

All reports will be reviewed promptly and handled as confidentially as reasonably possible. Retaliation against anyone who reports a concern or participates in an investigation is strictly prohibited.

2.4 Employment Classifications

Work Schedule Status:

Full-Time: Regularly scheduled to work 30 or more hours per week.

Part-Time: Regularly scheduled to work fewer than 30 hours per week.

Temporary/Seasonal: Hired for a defined period or specific project.

Overtime Status:

Exempt: Typically salaried roles that are exempt from overtime pay requirements.

Non-Exempt: Typically hourly roles that are eligible for overtime pay under applicable laws.

Your classification is stated in your offer letter and can be confirmed with People Operations.

2.5 Introductory Period

The first 90 days of employment are considered an introductory period. During this time:

You receive training and onboarding support.

Your manager provides feedback on performance and fit.

This period does not change the at-will nature of your employment.

3. Work Hours, Attendance & Scheduling
3.1 Standard Work Hours

NovaTech Labs operates primarily Monday through Friday. Our core collaboration hours are:

9:30 a.m. – 3:30 p.m. (local time)

During core hours, employees are generally expected to be available for meetings and collaboration, unless on approved leave.

Standard full-time schedule: 40 hours per week

Start and end times may be flexible with manager approval.

3.2 Flexible Work Arrangements

Where role and business needs allow, employees may have flexible schedules (e.g., 8–4, 10–6). Flex arrangements must be:

Discussed with and approved by your manager

Consistent and predictable, whenever possible

3.3 Attendance & Punctuality

Reliable attendance is essential. Employees are expected to:

Arrive (or be logged in) on time for their scheduled shifts and meetings

Notify their manager as early as possible if they will be late or absent

Follow the team’s established method for reporting absences (e.g., Slack, phone, or HR system)

Excessive or unexcused absences and chronic lateness may lead to corrective action.

3.4 Breaks & Meal Periods

Break and meal periods comply with applicable law.

General guidelines:

Non-exempt employees working more than 6 hours should take at least a 30-minute unpaid meal break.

Short paid rest breaks (e.g., 10–15 minutes) may be provided where required or customary.

Breaks should be scheduled to ensure adequate coverage and minimal disruption.

Your manager will provide specifics for your location and role.

3.5 Overtime (Non-Exempt Employees)

Non-exempt employees are eligible for overtime pay in accordance with applicable laws.

Overtime is generally defined as hours worked beyond 40 in a workweek, or as defined by local law.

All overtime must be pre-approved by your manager.

All hours worked must be accurately recorded in the timekeeping system.

Exempt employees are expected to complete their responsibilities and are generally not eligible for overtime pay.

3.6 Timekeeping

Non-exempt employees must:

Clock in/out or record time worked via the approved system

Record all hours actually worked, including overtime

Never work “off the clock”

Falsifying time records is a serious violation and may result in immediate termination.

4. Time Off, PTO & Holidays
4.1 Paid Time Off (PTO)

NovaTech Labs provides PTO for vacation, personal days, and general rest.

Accrual (Example Policy):

Full-time employees accrue 15 days (120 hours) of PTO per year.

PTO accrues each pay period and may be pro-rated based on start date.

Part-time employees accrue PTO proportionally based on scheduled hours.

PTO may accrue up to a maximum “bank” of 1.5 times your annual accrual. Once you hit the cap, accrual pauses until you use some time.

Using PTO:

Request PTO through the HR system or by the method defined by your team.

For planned time off, submit requests at least 2 weeks in advance.

Approval is based on business needs and team coverage.

Unplanned PTO (e.g., sudden illness) should be reported to your manager as soon as possible.

4.2 Sick Leave

Sick leave may be provided as a separate bank where required by law, or included in PTO.

Appropriate uses of sick leave include:

Personal illness or injury

Medical or dental appointments that cannot be scheduled outside work hours

Caring for an ill or injured immediate family member, where permitted

If you are out for more than 3 consecutive workdays, a doctor’s note or other documentation may be required.

4.3 Company Holidays

NovaTech Labs observes the following paid holidays (example list):

New Year’s Day

Martin Luther King Jr. Day

Memorial Day

Independence Day

Labor Day

Thanksgiving Day

Day After Thanksgiving

Christmas Eve

Christmas Day

The official holiday calendar is published annually and may vary slightly year to year.

Employees whose roles require working on a company holiday may receive alternate time off or premium pay consistent with company practices and applicable law.

4.4 Other Paid Leaves

Depending on role and location, employees may be eligible for:

Bereavement Leave: Up to 3 paid days following the death of an immediate family member.

Jury Duty: Reasonable paid time off for required jury service, where allowed by law.

Voting Leave: As required by local regulations.

Documentation may be required to verify eligibility.

4.5 Unpaid Leaves of Absence

In addition to legally mandated leaves (such as family and medical leave where applicable), NovaTech Labs may, at its discretion, approve unpaid leaves for personal reasons when operationally feasible.

Employees should:

Submit a written request describing the reason and anticipated length of leave.

Work with HR and their manager to determine eligibility and impact on benefits.

5. Compensation & Payroll
5.1 Pay Periods

Employees are paid twice per month (e.g., on the 15th and last business day of the month) or on another consistent schedule specified by the company.

5.2 Time Reporting

Non-exempt employees must accurately record hours worked each day.

Exempt employees may be asked to confirm that they worked their expected schedule.

5.3 Overtime Pay

Non-exempt employees receive overtime pay for all hours worked beyond applicable thresholds, at rates required by law (often 1.5x the regular rate of pay).

5.4 Payroll Deductions

The company will withhold from your paycheck:

Required taxes (federal, state, local where applicable)

Social security or similar contributions

Court-ordered garnishments, if applicable

Employee contributions to benefits (e.g., health premiums, retirement)

Review your pay statement for accuracy and report discrepancies promptly to HR or Payroll.

5.5 Direct Deposit

NovaTech Labs strongly encourages direct deposit. Employees may designate one or more accounts for their pay, subject to system capabilities.

6. Employee Benefits

(This section describes typical benefits; actual offerings may vary based on location and employment status.)

6.1 Eligibility

Generally:

Full-time employees are eligible for benefits after a waiting period (e.g., first of the month following 30 days of employment).

Part-time employees may be eligible for certain benefits on a pro-rated basis.

Temporary or contract workers may not be eligible for company benefits.

Details are provided in benefit plan documents, which govern in case of any conflict.

6.2 Health Insurance

NovaTech Labs strives to offer a competitive benefits package that may include:

Medical insurance

Dental insurance

Vision insurance

Coverage options, premiums, and carrier information are communicated during onboarding and annual open enrollment.

6.3 Retirement Plan

Eligible employees may participate in a 401(k) or similar retirement plan, which may include:

Pre-tax and/or Roth contributions

Employer matching contributions (if offered)

A range of investment options

Plan details, eligibility, and vesting schedules are outlined in the official plan documents.

6.4 Life & Disability Insurance

The company may provide:

Basic life insurance

Short-term and/or long-term disability insurance

Coverage amounts and eligibility are explained during onboarding and in benefits materials.

6.5 Wellness & Employee Assistance

NovaTech Labs encourages employee well-being and may offer:

Employee Assistance Program (EAP) for confidential counseling and support

Wellness initiatives (e.g., fitness challenges, workshops, stipends)

7. Code of Conduct & Workplace Behavior
7.1 General Expectations

Employees are expected to:

Perform their duties honestly and professionally

Treat colleagues, customers, vendors, and partners with respect

Follow company policies and comply with applicable laws

Safeguard company property and confidential information

Avoid behavior that disrupts the workplace or damages the company’s reputation

7.2 Professional Communication

We maintain a culture of constructive, respectful dialogue. This applies to:

In-person conversations

Email and chat (e.g., Slack, Teams)

Video meetings

Internal and external communications

Offensive, abusive, or harassing language is not tolerated.

7.3 Conflict of Interest

Employees must avoid situations where personal interests conflict—or appear to conflict—with the interests of NovaTech Labs. Examples include:

Working for a competitor without disclosure and approval

Using company resources for personal business ventures

Accepting gifts or favors that might influence decision-making

If you are unsure whether something constitutes a conflict of interest, consult your manager or HR.

7.4 Gifts & Entertainment

Small, customary business gifts may be acceptable, but:

Cash or cash equivalents should not be accepted.

Any gift or entertainment that could appear to influence business decisions must be declined or discussed with your manager.

7.5 Drugs, Alcohol & Substance Use

NovaTech Labs is committed to a safe and productive workplace.

Working while impaired by drugs or alcohol is prohibited.

Illegal substances are not permitted on company property or while performing company business.

Moderate alcohol consumption may be allowed at approved company events, but employees must act responsibly and professionally.

7.6 Workplace Violence & Weapons

Threats, intimidation, bullying, and acts of violence are strictly prohibited. Weapons are not allowed on company premises, in company vehicles, or while conducting company business, subject to applicable law.

8. Dress Code & Workplace Appearance
8.1 General Standard

NovaTech Labs maintains a “professional but comfortable” environment.

Clothing should be clean, neat, and in good condition.

Avoid attire with offensive, profane, or discriminatory images or text.

Personal hygiene and grooming should be appropriate for a professional setting.

8.2 Office & Client-Facing Roles

Business casual is generally appropriate, such as:

Collared shirts, blouses, sweaters, or neat tops

Slacks, chinos, or skirts/dresses of appropriate length

Clean shoes or professional sneakers

When meeting with clients or attending formal events, more traditional business attire may be required.

8.3 Remote & Hybrid Employees

For remote work and virtual meetings:

Clothing should be casual-professional and non-distracting.

Backgrounds should be tidy or use a professional virtual background.

Follow client or meeting-specific expectations if provided.

9. Remote Work & Hybrid Policy
9.1 Eligibility

Remote or hybrid work arrangements depend on:

The nature of your role

Team and business needs

Manager approval

Some roles may require primarily on-site presence (e.g., facilities, certain operations roles).

9.2 Expectations for Remote Work

Remote employees are expected to:

Maintain a safe and private workspace

Have reliable internet and necessary equipment

Be reachable via agreed communication tools during core hours

Join scheduled meetings on time, with video on when requested (barring accommodations)

9.3 Security & Confidentiality

Remote employees must:

Use company-approved devices where possible

Follow all IT and security policies (see Section 10)

Avoid working in public spaces where confidential information may be viewed or overheard

Lock devices when away from their workstation

9.4 Expenses & Equipment

The company may provide equipment such as:

Laptop computer

Monitor, keyboard, mouse, headset

Reasonable business expenses (e.g., certain collaboration tools) may be reimbursed per the expense policy. Home internet and utilities are generally the employee’s responsibility unless otherwise required or specified.

10. Equipment, Technology & IT Usage
10.1 Company Property

Company-issued equipment (laptops, phones, monitors, badges, etc.):

Remains the property of NovaTech Labs

Must be used primarily for business purposes

Must be returned upon termination of employment or when requested

Employees are expected to protect company property from loss, theft, or damage.

10.2 Acceptable Use of Technology

Company systems (email, messaging, internet, applications) are provided for business use. Limited personal use may be permitted if it:

Does not interfere with job responsibilities

Does not violate any laws or company policies

Does not consume excessive resources

Employees must not use company systems to:

Access, create, or share offensive, harassing, illegal, or inappropriate content

Engage in personal commercial activity or outside employment that conflicts with company interests

Bypass security controls or install unauthorized software

10.3 Data Security & Privacy

Employees must:

Use strong, unique passwords and enable multifactor authentication where available

Never share passwords with others

Store confidential information only in approved company systems

Report lost devices or suspected data breaches immediately to IT Security

10.4 Personal Devices (BYOD)

If personal devices are used for work (e.g., checking email on a personal phone), employees must:

Follow company security requirements (e.g., screen lock, encryption, MDM if required)

Understand that work data on personal devices may need to be wiped in certain situations (e.g., device loss)

11. Health, Safety & Security
11.1 General Safety

NovaTech Labs is committed to providing a safe and healthy work environment.

Employees should:

Follow all safety instructions and signage

Keep work areas clean and uncluttered

Report unsafe conditions, incidents, or near-misses to their manager or HR

11.2 Emergency Procedures

Employees should familiarize themselves with:

Emergency exits and evacuation routes

Assembly points outside the building

Procedures for fire, severe weather, or other emergencies

In an emergency, follow instructions from local authorities, building staff, or designated safety leads.

11.3 Building Access & Security

Employees are issued access badges or keys as needed.

Do not lend badges or share access codes.

Report lost or stolen badges immediately.

Visitors must be signed in and escorted by an employee while on premises.

12. Performance Management & Development
12.1 Performance Expectations

Employees are expected to:

Understand their role responsibilities and goals

Communicate proactively about progress and challenges

Seek feedback and coaching

Collaborate effectively with teammates

12.2 Check-Ins & Reviews

Typical performance management at NovaTech Labs includes:

Regular 1:1s between employees and managers

At least one formal review cycle per year (mid-year and/or annual)

Goal setting aligned with team and company objectives

12.3 Training & Development

NovaTech Labs encourages ongoing growth and may offer:

Onboarding and role-specific training

Skills workshops and online learning resources

Opportunities to attend relevant conferences or courses, with approval

13. Corrective Action & Separation
13.1 Corrective Action

When performance, attendance, or conduct does not meet expectations, NovaTech Labs may use a progressive approach, which can include:

Informal coaching and feedback

Verbal warning

Written warning or performance improvement plan (PIP)

Suspension or termination

The company may skip steps or proceed directly to termination based on the seriousness of the issue and business needs.

13.2 Voluntary Resignation

Employees who choose to resign are encouraged to:

Provide at least two weeks’ notice in writing

Work with their manager to transition responsibilities

Participate in an exit interview, if requested

13.3 Involuntary Termination

In situations where employment is terminated by the company, HR and the manager will:

Communicate the decision to the employee

Outline final pay and benefits information

Arrange for the return of company property and system access removal

13.4 Final Pay & Benefits

Final pay will be processed in accordance with applicable laws and may include:

Salary/wages through the last day worked

Payment for accrued but unused PTO when required by law or company policy

Information about continuation of benefits, if applicable (e.g., COBRA in the U.S.)

14. Onboarding Overview for New Employees

This section is especially useful for your onboarding chatbot to reference.

14.1 Before Your First Day

New hires typically receive:

An offer letter and new-hire paperwork via email

Instructions for completing any background checks or work eligibility verification

A welcome packet outlining your first week’s schedule

You may be asked to:

Complete tax and direct deposit forms

Review and sign key policies (e.g., code of conduct, confidentiality)

Submit any necessary identification documents

14.2 Your First Day

On your first day, you can generally expect:

A welcome meeting and introduction to your manager and team

Orientation covering company history, values, and structure

Setup of your workstation, email, and required software

An overview of this handbook and other essential policies

14.3 Your First Week

During your first week, you will usually:

Complete mandatory training (e.g., security awareness, anti-harassment)

Review role responsibilities and initial goals with your manager

Be added to relevant communication channels and tools

Learn about benefits and enrollment deadlines

14.4 Your First 90 Days

In your first 90 days:

You’ll have check-ins with your manager to review progress and answer questions.

You should feel increasingly comfortable with your responsibilities and tools.

By the end of this period, your manager will hold a more formal review of your onboarding and performance so far.

15. Acknowledgment

Employees may be asked to sign an acknowledgment confirming that they:

Have received and reviewed the NovaTech Labs Employee Handbook.

Understand that it is their responsibility to read and comply with the policies.

Understand that the handbook may be amended and that the most current version supersedes previous versions.

Understand that nothing in the handbook alters the at-will nature of employment where applicable.
`.trim();

// Optional: customize these bits of wording
const COMPANY_NAME = "Your Company Name";
const DENY_MESSAGE =
  "I’m only able to help with questions about new employee onboarding and official company policies. " +
  "For other topics, please contact the appropriate person or use another resource.";

// =====================
// 2. Shared helpers
// =====================

const chatLog = document.getElementById("chat-log");
const chatForm = document.getElementById("chat-form");
const userInput = document.getElementById("user-input");
const apiKeyInput = document.getElementById("api-key-input");
const providerSelect = document.getElementById("provider-select");

function appendMessage(sender, text, options = {}) {
  const wrapper = document.createElement("div");
  wrapper.className = `message ${sender}`;

  const bubble = document.createElement("div");
  bubble.className = "bubble";

  if (options.isTemporary) {
    bubble.dataset.temp = "true";
  }

  bubble.textContent = text;
  wrapper.appendChild(bubble);
  chatLog.appendChild(wrapper);

  chatLog.scrollTop = chatLog.scrollHeight;
}

function replaceLastTempBotMessage(text) {
  const bubbles = chatLog.querySelectorAll(".message.bot .bubble");
  for (let i = bubbles.length - 1; i >= 0; i--) {
    const bubble = bubbles[i];
    if (bubble.dataset.temp === "true") {
      bubble.textContent = text;
      delete bubble.dataset.temp;
      chatLog.scrollTop = chatLog.scrollHeight;
      return;
    }
  }
  appendMessage("bot", text);
}

// Build a single system prompt string we can reuse for both providers
function getSystemPrompt() {
  return `
You are a helpful HR onboarding assistant for ${COMPANY_NAME}.

SCOPE:
- You are ONLY allowed to answer questions about:
  (a) new employee onboarding at ${COMPANY_NAME}, and
  (b) official company policies.
- If the user asks anything outside that scope (for example: personal questions, world knowledge,
  technical questions unrelated to onboarding/policy, sports, politics, etc.), you MUST NOT answer.
  Instead, respond with this exact message (and nothing else):

  "${DENY_MESSAGE}"

KNOWLEDGE SOURCE:
- Use ONLY the information from the company handbook below.
- If the user asks about something that is not covered or not clear in the handbook, say you don't know
  and suggest they contact HR or their manager.
- Do NOT invent policies or make assumptions that are not supported by the handbook.

STYLE:
- Be concise and clear.
- When relevant, refer to specific sections or headings from the handbook if they exist.

COMPANY HANDBOOK:
"""${HANDBOOK_TEXT}"""
  `.trim();
}

// Initial greeting
appendMessage(
  "bot",
  `Hi! I’m your ${COMPANY_NAME} onboarding assistant.\n\n` +
    `I can answer questions about:\n` +
    `• New employee onboarding steps\n` +
    `• Company policies and procedures\n\n` +
    `If you ask about anything else, I’ll politely let you know I’m limited to onboarding and policies.\n\n` +
    `You can switch between OpenAI and Gemini at the top as long as you have the correct API key.`
);

// =====================
// 3. OpenAI API call
// =====================

async function callOpenAI(apiKey, userMessage) {
  const endpoint = "https://api.openai.com/v1/chat/completions";
  const systemPrompt = getSystemPrompt();

  const body = {
    model: "gpt-4o-mini",
    temperature: 0.2,
    messages: [
      { role: "system", content: systemPrompt },
      { role: "user", content: userMessage },
    ],
  };

  const response = await fetch(endpoint, {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      Authorization: `Bearer ${apiKey}`,
    },
    body: JSON.stringify(body),
  });

  const data = await response.json();

  if (!response.ok) {
    const message =
      (data && data.error && data.error.message) ||
      `OpenAI request failed with status ${response.status}`;
    throw new Error(message);
  }

  const reply =
    data.choices && data.choices[0] && data.choices[0].message.content;
  return (reply || "").trim();
}

// =====================
// 4. Gemini API call
// =====================
// Uses REST generateContent endpoint:
// POST https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent
// Header: x-goog-api-key: YOUR_API_KEY
// Body: { system_instruction, contents } :contentReference[oaicite:2]{index=2}

async function callGemini(apiKey, userMessage) {
  const endpoint =
    "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent";
  const systemPrompt = getSystemPrompt();

  const payload = {
    system_instruction: {
      parts: [{ text: systemPrompt }],
    },
    contents: [
      {
        role: "user",
        parts: [{ text: userMessage }],
      },
    ],
  };

  const response = await fetch(endpoint, {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "x-goog-api-key": apiKey,
    },
    body: JSON.stringify(payload),
  });

  const data = await response.json();

  if (!response.ok) {
    const message =
      (data && data.error && (data.error.message || data.error.status)) ||
      `Gemini request failed with status ${response.status}`;
    throw new Error(message);
  }

  // Typical Gemini generateContent response:
  // data.candidates[0].content.parts[0].text :contentReference[oaicite:3]{index=3}
  const candidates = data.candidates || [];
  const first = candidates[0];
  const parts = first && first.content && first.content.parts;
  const text = parts && parts[0] && parts[0].text;
  return (text || "").trim();
}

// =====================
// 5. Form submit handler
// =====================

chatForm.addEventListener("submit", async (event) => {
  event.preventDefault();

  const apiKey = apiKeyInput.value.trim();
  const text = userInput.value.trim();
  const provider = providerSelect.value;

  if (!text) return;

  if (!apiKey) {
    alert("Please enter your API key first.");
    return;
  }

  appendMessage("user", text);
  userInput.value = "";
  userInput.focus();

  appendMessage("bot", "Thinking...", { isTemporary: true });
  chatForm.querySelector("button").disabled = true;

  try {
    let reply;
    if (provider === "gemini") {
      reply = await callGemini(apiKey, text);
    } else {
      reply = await callOpenAI(apiKey, text);
    }

    replaceLastTempBotMessage(
      reply || "I didn’t get a response back from the model."
    );
  } catch (err) {
    console.error(err);
    replaceLastTempBotMessage(
      "Sorry, I ran into an error talking to the AI service:\n\n" +
        err.message +
        "\n\nPlease check your provider selection, API key, and try again."
    );
  } finally {
    chatForm.querySelector("button").disabled = false;
  }
});
